%br
- if @user.new_record?
  - url = create_user_users_path
  - method = :post
- else
  - url = user_path
  - method = :put
  
  
= simple_form_for @user, :url => url, :method => method, :html => {:class => "guarded_form form-horizontal"} do |f| 
  .row
    .span5
      %h4= t('.general')
      %hr
      = f.input :firstname, :required => false
      = f.input :lastname, :required => false
      = f.input :role, :collection => User.roles, :include_blank => false
      = f.input :deleted, :collection => [[t('form_values.user_is_active'), false],[t('form_values.user_is_marked_as_deleted'), true]], :include_blank => false,  :label => t(:delete) 

    .span5
      %h4= t('.account')
      %hr  
      = f.input :email
      = f.input :secondary_email
      = f.input :password  
      = f.input :password_confirmation  

  .row
    .span5
      %h4= t('.required_fields')
      %hr    
      - Datafields.required.each do |field|
        = field.add_to_form(f)
  
    .span5  
      %h4= t('.optional_fields')
      %hr      
      - Datafields.optional.each do |field|
        = field.add_to_form(f, :hint => false)
  
  
  %br
  = f.submit t(:save), :class => "guarded_form_save btn btn-primary"
  
  
  
  /todo= f.input :profession_id, :collection => Profession.all.map{|s| [s.name, s.id]}
   
  