@reload = -> 
  i=60
  window.setTimeout 'location.reload()', 60000
  window.setInterval ( -> $('#time_info').html((--i))), 1000 

$ ->
        
  # Search form.  
  $('#experiment_search').submit ->
    $.get this.action, $(this).serialize(), null, 'script'  
    false
    
  
  $('.accordion .toggle').hide();

  $('.accordion td h4').click ->
    $(this).parent().find('.toggle').slideToggle(200)
    $(this).parent().find('i').toggleClass('icon-chevron-right')
    $(this).parent().find('i').toggleClass('icon-chevron-down')
    

  # ajax for enabling and disabling of experiment enrollment
  $('#state').on 'click', '#state_button_enable',  ->
    $("#state").load "<%= (Hroot::Application.config.path_prefix || '') %>/admin/experiments/"+$(this).attr("data-id")+"/enable"
  
  $('#state').on 'click', '#state_button_disable',  ->
    $("#state").load "<%= (Hroot::Application.config.path_prefix || '') %>/admin/experiments/"+$(this).attr("data-id")+"/disable"
  
  check_form_enabling = ->
    if $('#reminder_check').attr('checked')
      $('.subpart').show()
    else
      $('.subpart').hide()
  
  check_form_enabling()
  
  # enabling / disabling the reminder
  $('#reminder_check').click ->
    check_form_enabling()